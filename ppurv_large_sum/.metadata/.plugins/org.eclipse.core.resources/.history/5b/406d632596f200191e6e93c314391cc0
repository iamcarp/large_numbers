/*
 * main.c
 *
 *  Created on: Oct 18, 2019
 *      Author: Luka Karan RA50/2016
 */


#include "sum.h"


//static int_least16_t pomeraj;

#define ARG_NUM 4

#define EXIT_SUCCESS  0
#define EXIT_FAILURE -1


int_least8_t main(int_least8_t argc, const int_least8_t *argv[])
{
	void* handle;
	void (*magic)(const int_least8_t*, const int_least8_t*);

	if (argc != ARG_NUM)
	{
		fprintf(stderr, "Wrongly called program.\n");

		return EXIT_FAILURE;
	}

	if (*(argv[1]) == '+')
	{
		handle = dlopen("libmmath.so", RTLD_LAZY);
		if (handle == NULL) {
			printf("No No\n");
			return EXIT_FAILURE;
		}

		magic = dlsym(handle, "addNums");
		(*magic)(argv[2], argv[3]);

	else
	{
		fprintf(stderr, "Unknown operation: %s.\n", argv[1]);

		return EXIT_FAILURE;
	}


	return EXIT_SUCCESS;
}
